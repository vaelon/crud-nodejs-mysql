# Lightrun for Node.js

[Lightrun](https://lightrun.com) is a developer-native observabity platform. It's a way to add logs, inspect the state of the current execution (in a familiar, debugger-like view), and extract any type of code-level metric **on the fly** - without redeploying, restarting or even stopping the running application.

Check out our [docs](https://docs.lightrun.com/node/agent/) to learn more.

## Getting Started

To get started with Lightrun you'll need three things:

1. A Lightrun Account - you can get one [here](https://app.lightrun.com/api/oauth/register).
2. A Lightrun Plugin - you'll have instructions to download it once you create an account, but you can also check them out [here](https://docs.lightrun.com/node/plugin/).
3. A Lightrun Agent - which is this very NPM package! It's the thing that actually does the magic.

Once you've signed up for an account and downloaded the plugin, you can install the agent in your application.

## Installing the Lightrun Agent

In order to install the Lightrun Node Agent please follow these steps:

1. In your project's folder, install the node agent by running `npm install lightrun`.

2.
    a. **For regular Node.js applications** - Require Lightrun at the start of your your application file (i.e. `index.js` or `app.js`):

    ```javascript
    require('lightrun').start({
        lightrunSecret: '<COMPANY-SECRET>',
    });
    ```

    b. **For TypeScript applications** - Import Lightrun at the start of your your application file (i.e. `index.ts` or `app.ts`) and then start it:

    ```javascript
    import * as lightrun from 'lightrun';

    lightrun.start({
        lightrunSecret: '<COMPANY-SECRET>',
    });
    ```

    You will have a `<COMPANY-SECRET>` auto-generated for you during the onbaording process, right after signing up for an account.
    ### Important Note - Sourcemap Files
    Lightrun for TypeScript needs to have [sourcemap files](https://www.typescriptlang.org/tsconfig#sourceMap) available to it in order to work properly. Please make sure to [set `sourceMap` to `true` when compiling your TypeScript code](https://www.typescriptlang.org/tsconfig#sourceMap).

3. Run the application as you normally would.

You should now see the application's agent popping up in the Lightrun Plugin's sidebar - you can now add [logs](https://docs.lightrun.com/logs/), [snapshots](https://docs.lightrun.com/snapshots-plugin/) and [metrics](https://docs.lightrun.com/metrics/) to your application.

### Providing Credentials Via Environment Variables

You can optionally choose to provide the `<COMPANY-SECRET>` via environment variables to the Node process.
To do so, follow these steps after installing the agent (**note that this does not work on Windows**):

1. Import Lightrun at the start of the file:

```javascript
require('lightrun').start();
```

2. Run the application with the environment variables provided before the `node` command:

```javascript
LIGHTRUN_SECRET=<COMPANY_SECRET> node index.js
```
